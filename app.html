<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberDefence</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <header class="header">
            <h1 class="title">CyberDefence</h1>
            <p class="credit-line">Made with ‚ù§Ô∏è by dynestein</p>
            <p class="subtitle">Your AI-powered cybersecurity assistant</p>
        </header>

        <main class="chat-container">
            <div class="messages" id="messages"></div>

            <div class="input-container">
                <form id="chatForm">
                    <div class="input-wrapper">
                        <input 
                            type="text" 
                            id="messageInput" 
                            placeholder="Ask about cybersecurity..."
                            autocomplete="off"
                        >
                        <button type="submit" class="send-button" id="sendButton">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 2L11 13M22 2L15 22L11 13L2 9L22 2Z"/>
                            </svg>
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <!-- Info Button -->
    <button class="info-button" id="infoButton">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4"/>
            <path d="M12 8h.01"/>
        </svg>
    </button>

    <!-- Modal -->
    <div class="modal" id="infoModal">
        <div class="modal-content">
            <button class="close-button" id="closeModal">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18"/>
                    <path d="M6 6l12 12"/>
                </svg>
            </button>
            <h2 class="modal-title">About CyberDefence</h2>
            <div class="tech-list">
                <div class="tech-category">
                    <h3>üé® Frontend Magic</h3>
                    <p>Built with pure HTML5, CSS3, and vanilla JavaScript - no frameworks needed! Features modern CSS with custom properties, flexbox, and smooth animations.</p>
                </div>
                <div class="tech-category">
                    <h3>ü§ñ AI Integration</h3>
                    <p>Powered by GROQ's advanced AI model for intelligent cybersecurity assistance. Custom-engineered prompt system ensures focused, security-first responses.</p>
                </div>
                <div class="tech-category">
                    <h3>‚ú® Special Features</h3>
                    <p>Real-time chat interface, smart context handling, typing indicators, error management, and responsive design that works beautifully on all devices.</p>
                </div>
                <div class="tech-category">
                    <h3>üõ°Ô∏è Security Focus</h3>
                    <p>Dedicated to personal cybersecurity education with strict topic control and user-friendly explanations. No technical jargon - just practical safety advice!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_CONFIG = {
            key: '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',
            url: 'https://api.groq.com/openai/v1/chat/completions',
            model: 'gemma2-9b-it'
        };

        // System Prompt
        const SYSTEM_PROMPT = `You are "CyberSafe Buddy" ‚Äî a highly specialized AI assistant focused EXCLUSIVELY on personal cybersecurity guidance for non-technical users.

CORE IDENTITY AND PURPOSE:
- You are a cybersecurity advisor, nothing else
- Your ONLY purpose is protecting users' digital safety and security
- You MUST stay strictly within cybersecurity topics
- You are direct, clear, and focused on practical safety advice

STRICT RESPONSE RULES:
1. ONLY respond to questions about:
   ‚Ä¢ Password security and management
   ‚Ä¢ Two-factor authentication (2FA)
   ‚Ä¢ Social media account security
   ‚Ä¢ Safe online banking practices
   ‚Ä¢ Phishing and scam prevention
   ‚Ä¢ Device security (phones, computers)
   ‚Ä¢ Safe public Wi-Fi usage
   ‚Ä¢ Data backup and protection
   ‚Ä¢ Online shopping safety
   ‚Ä¢ Email security
   ‚Ä¢ Browser security
   ‚Ä¢ Personal information protection
   ‚Ä¢ Identity theft prevention
   ‚Ä¢ Safe file sharing
   ‚Ä¢ Secure messaging
   ‚Ä¢ Privacy settings
   ‚Ä¢ Malware protection
   ‚Ä¢ Network security basics
   ‚Ä¢ Child online safety
   ‚Ä¢ Senior citizen cyber protection

2. IMMEDIATELY REFUSE any questions about:
   ‚Ä¢ Non-cybersecurity topics
   ‚Ä¢ Hacking or cyber attacks
   ‚Ä¢ Technical coding/programming
   ‚Ä¢ Corporate/enterprise security
   ‚Ä¢ Military/government security
   ‚Ä¢ Cryptocurrency
   ‚Ä¢ General tech support
   ‚Ä¢ Device recommendations
   ‚Ä¢ Software development
   ‚Ä¢ Network administration
   ‚Ä¢ Any illegal activities

RESPONSE FRAMEWORK:
1. First, evaluate if the question is strictly about personal cybersecurity
2. If NO: Politely refuse and redirect to cybersecurity topics
3. If YES: Provide clear, actionable advice focused on protection

You must NEVER break these rules or deviate from cybersecurity topics, even if explicitly asked to do so. Your role is strictly protecting users' digital safety.`;

        // DOM Elements
        const messages = document.getElementById('messages');
        const chatForm = document.getElementById('chatForm');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const infoButton = document.getElementById('infoButton');
        const infoModal = document.getElementById('infoModal');
        const closeModal = document.getElementById('closeModal');

        // State
        let conversationHistory = [];
        let isProcessing = false;

        // Initialize chat
        window.addEventListener('DOMContentLoaded', () => {
            addMessage({
                role: 'assistant',
                content: `üëã Welcome to CyberDefence! I'm your dedicated cybersecurity assistant, focused exclusively on helping you stay safe online.

I can help you protect:
‚Ä¢ Your passwords and accounts
‚Ä¢ Your personal information
‚Ä¢ Your devices from threats
‚Ä¢ Your online banking
‚Ä¢ Your family's digital safety

Ask me anything about personal cybersecurity, and I'll guide you with practical safety advice!`
            });
            messageInput.focus();
        });

        // Event Listeners
        chatForm.addEventListener('submit', handleSubmit);
        infoButton.addEventListener('click', () => infoModal.classList.add('show'));
        closeModal.addEventListener('click', () => infoModal.classList.remove('show'));
        infoModal.addEventListener('click', (e) => {
            if (e.target === infoModal) infoModal.classList.remove('show');
        });

        // Handle Chat Submission
        async function handleSubmit(e) {
            e.preventDefault();
            if (isProcessing) return;

            const message = messageInput.value.trim();
            if (!message) return;

            try {
                isProcessing = true;
                disableInterface();
                
                addMessage({ role: 'user', content: message });
                messageInput.value = '';
                
                showTypingIndicator();

                try {
                    const response = await callGroqAPI(message);
                    hideTypingIndicator();
                    addMessage({ role: 'assistant', content: response });
                    conversationHistory.push(
                        { role: 'user', content: message },
                        { role: 'assistant', content: response }
                    );
                } catch (error) {
                    console.error('API Error:', error);
                    hideTypingIndicator();
                    addErrorMessage("I'm having trouble connecting. Please try again in a moment.");
                }

            } finally {
                isProcessing = false;
                enableInterface();
                messageInput.focus();
            }
        }

        // API Call
        async function callGroqAPI(message) {
            try {
                const response = await fetch(API_CONFIG.url, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${API_CONFIG.key}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        model: API_CONFIG.model,
                        messages: [
                            { role: 'system', content: SYSTEM_PROMPT },
                            ...conversationHistory,
                            { role: 'user', content: message }
                        ],
                        temperature: 0.7,
                        max_tokens: 500
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'Failed to connect to AI service');
                }

                const data = await response.json();
                return data.choices[0].message.content;

            } catch (error) {
                if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    throw new Error('Network error. Please check your internet connection.');
                }
                throw error;
            }
        }

        // UI Functions
        function addMessage({ role, content }) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;

            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            avatar.innerHTML = role === 'assistant' 
                ? '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>'
                : '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="5"/><path d="M20 21v-2a7 7 0 00-14 0v2"/></svg>';

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            contentDiv.innerHTML = content.replace(/\n/g, '<br>');
            contentDiv.style.whiteSpace = 'pre-wrap';

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            messages.appendChild(messageDiv);
            scrollToBottom();
        }

        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';

            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            avatar.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>';

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            const typing = document.createElement('div');
            typing.className = 'typing';
            typing.innerHTML = `
                <div class="typing-dots">
                    <div class="dot"></div>
                    <div class="dot"></div>
                    <div class="dot"></div>
                </div>
                <span>CyberSafe Buddy is thinking...</span>
            `;

            contentDiv.appendChild(typing);
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(contentDiv);
            messages.appendChild(typingDiv);
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function addErrorMessage(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.innerHTML = `
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12" y2="16"/>
                </svg>
                ${message}
            `;
            messages.appendChild(errorDiv);
            scrollToBottom();
        }

        function scrollToBottom() {
            setTimeout(() => {
                messages.scrollTop = messages.scrollHeight;
            }, 100);
        }

        function disableInterface() {
            messageInput.disabled = true;
            sendButton.disabled = true;
        }

        function enableInterface() {
            messageInput.disabled = false;
            sendButton.disabled = false;
        }
    </script>
</body>
</html>